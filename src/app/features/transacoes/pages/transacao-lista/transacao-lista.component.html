<div class="page-container">
  <header class="page-header">
    <h2>Lançamentos</h2>

    <div class="date-navigator">
      <button mat-icon-button><mat-icon>chevron_left</mat-icon></button>
      <span>Janeiro 2026</span>
      <button mat-icon-button><mat-icon>chevron_right</mat-icon></button>
    </div>

    <button mat-icon-button><mat-icon>more_vert</mat-icon></button>
  </header>

  <div class="filter-bar">
    <div class="left-group">
      <mat-icon class="bank-icon">account_balance</mat-icon>

      <mat-form-field
        appearance="outline"
        subscriptSizing="dynamic"
        class="custom-field"
      >
        <mat-label>Selecione a conta</mat-label>
        <mat-select
          [(ngModel)]="contaSelecionada"
          (selectionChange)="filtrarTransacoes()"
        >
          <mat-option [value]="null">Todas as contas</mat-option>

          <mat-option *ngFor="let conta of listaContas" [value]="conta">
            {{ conta.nome }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="search-group">
      <input
        type="text"
        placeholder="Buscar lançamento..."
        class="search-input"
        [(ngModel)]="termoBusca"
        (keyup)="filtrarTransacoes()"
      />
      <mat-icon>search</mat-icon>
    </div>

    <div class="action-buttons">
      <button
        mat-raised-button
        class="btn-receita"
        (click)="abrirNovaTransacao('RECEITAS')"
      >
        <mat-icon>arrow_upward</mat-icon> Receita
      </button>
      <button
        mat-raised-button
        class="btn-despesa"
        (click)="abrirNovaTransacao('GASTOS')"
      >
        <mat-icon>arrow_downward</mat-icon> Despesa
      </button>
    </div>
  </div>

  <div class="transactions-list">
    <div *ngIf="transacoesFiltradas.length > 0" class="list-header">
      <small>Data</small>
      <small>Descrição</small>
      <small class="text-right">Valor</small>
    </div>

    <div class="transacao-row" *ngFor="let item of transacoesPaginadas">
      <div class="row-left">
        <div class="data-box">
          <span class="dia">{{ item.data | date: "dd" }}</span>
          <span class="mes">{{ item.data | date: "MMM" }}</span>
        </div>

        <div
          class="status-icon"
          [class.efetivado]="
            item.status === 'PENDENTE' || item.status === 'PAGO'
          "
          [matTooltip]="item.status"
        >
          <mat-icon>check</mat-icon>
        </div>

        <div class="info">
          <span class="descricao">{{ item.descricao }}</span>
          <span class="conta-tag">
            <mat-icon class="tiny-icon">account_balance</mat-icon>
            {{ item.contaNome }}
          </span>
        </div>
      </div>

      <div class="row-right">
        <span
          class="valor"
          [class.receita]="item.tipo === 'RECEITAS'"
          [class.gasto]="item.tipo === 'GASTOS'"
        >
          {{ item.tipo === "RECEITAS" ? "+" : "-" }}
          R$ {{ item.valor | number: "1.2-2" }}
        </span>

        <button
          mat-icon-button
          [matMenuTriggerFor]="menu"
          (click)="$event.stopPropagation()"
        >
          <mat-icon>more_vert</mat-icon>
        </button>

        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)="editarTransacao(item)">
            <mat-icon>edit</mat-icon>
            <span>Editar</span>
          </button>
          <button mat-menu-item (click)="excluirTransacao(item)">
            <mat-icon color="warn">delete</mat-icon>
            <span style="color: #f44336">Excluir</span>
          </button>
        </mat-menu>
      </div>
    </div>

    <div *ngIf="transacoesFiltradas.length === 0" class="empty-state">
      <mat-icon>search_off</mat-icon>
      <p>Nenhum lançamento encontrado.</p>
    </div>

    <mat-paginator
      [length]="transacoesFiltradas.length"
      [pageSize]="10"
      [pageSizeOptions]="[5, 10, 20]"
      (page)="atualizarPagina($event)"
      showFirstLastButtons
      aria-label="Selecionar página"
    >
    </mat-paginator>
  </div>
</div>
