<div class="dashboard-container">
  <section class="summary-header">
    <div class="welcome">
      <h2>{{ saudacao }}, {{ nomeUsuario }}</h2>
      <div class="stats">
        <div class="stat-item">
          <small>Receitas no mês</small>
          <p class="text-success">
            {{ resumo.receitas | currency: "BRL" : "symbol" : "1.2-2" }}
          </p>
        </div>

        <div class="stat-item">
          <small>Despesas no mês</small>
          <p class="text-danger">
            {{ resumo.despesas | currency: "BRL" : "symbol" : "1.2-2" }}
          </p>
        </div>
      </div>
    </div>
  </section>

  <div class="dashboard-grid">
    <app-v-card titulo="Minhas contas">
      <div *ngIf="contas.length > 0" class="lista-resumo">
        <div class="conta-row" *ngFor="let conta of contas">
          <div class="conta-info">
            <div class="icon-bg">
              <mat-icon class="icon-small">account_balance_wallet</mat-icon>
            </div>
            <span class="conta-nome">{{ conta.nome }}</span>
          </div>
          <span class="conta-valor" [class.negativo]="conta.saldo < 0">
            R$ {{ conta.saldo | number: "1.2-2" }}
          </span>
        </div>

        <mat-divider class="custom-divider"></mat-divider>

        <div class="card-footer">
          <div class="total-box">
            <small>Saldo Geral</small>
            <strong>R$ {{ saldoTotal | number: "1.2-2" }}</strong>
          </div>
          <button
            mat-button
            color="primary"
            routerLink="/sistema/dashboard/contas"
          >
            Ver todas
          </button>
        </div>
      </div>

      <div *ngIf="contas.length === 0" class="empty-state">
        <mat-icon>account_balance</mat-icon>
        <p>Adicione sua primeira conta</p>
        <button
          mat-flat-button
          color="primary"
          routerLink="/sistema/dashboard/contas"
        >
          Gerenciar contas
        </button>
      </div>
    </app-v-card>

    <app-v-card titulo="Meus cartões">
      <div *ngIf="cartoes.length > 0; else noCards">
        <div class="cards-list">
          <div class="mini-card-item" *ngFor="let card of cartoes">
            <div class="card-icon-area">
              <mat-icon>credit_card</mat-icon>
            </div>

            <div class="card-details">
              <div class="card-top-row">
                <span class="card-name">{{ card.nome }}</span>
                <span class="card-disp">
                  {{ card.limiteDisponivel | currency: "BRL" }}
                </span>
              </div>

              <mat-progress-bar
                mode="determinate"
                [value]="(card.limiteDisponivel / card.limiteTotal) * 100"
                class="custom-progress"
              >
              </mat-progress-bar>

              <div class="card-bot-row">
                <small>Disponível</small>
                <small>Total: {{ card.limiteTotal | currency: "BRL" }}</small>
              </div>
            </div>
          </div>
        </div>

        <mat-divider class="custom-divider"></mat-divider>
        <div class="card-footer-actions">
          <button mat-button color="primary" routerLink="/sistema/cartoes">
            Gerenciar cartões
          </button>
        </div>
      </div>

      <ng-template #noCards>
        <div class="empty-state">
          <mat-icon>credit_card</mat-icon>
          <p>Adicione seu primeiro cartão</p>
          <button mat-button color="primary" routerLink="/sistema/cartoes">
            Gerenciar cartões
          </button>
        </div>
      </ng-template>
    </app-v-card>
  </div>
</div>
